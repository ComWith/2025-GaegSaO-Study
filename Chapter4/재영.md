# 📘 04 / 역할, 책임, 협력

- **행동은 본질적 특성이 아니라 처한 상황이나 정황(문맥, Context)** 이 결정한다.  
  → 객체의 행동은 **협력**이라는 문맥 속에서 정의된다.


- 설계의 품질은 **개별 객체**가 아니라 **객체들 간 협력의 품질**이 좌우한다.


- 어떤 **협력에 참여**하는지가 객체에 필요한 **행동을 결정**하고, 필요한 행동이 객체의 **상태를 결정**한다.

⇒ 개별적인 객체의 행동이나 상태가 아니라 객체들 간의 협력에 집중하라.

## 협력(Collaboration)

---

- 협력은 **요청(request)** 과 **응답(response)** 의 연쇄로 이루어진다.
- 동일한 목적을 향해 여러 객체가 협력하며, 요청을 수락하려면 **응답에 필요한 지식과 행동**을 보유해야 한다.
- 요청/응답의 연결이 곧 객체가 수행할 **책임**을 규정한다.

## 책임(Responsibility)

---

> 객체가 외부로 약속하는 **행동의 집합**. ‘무엇을 할 수 있는가(Doing)’와 ‘무엇을 알고 있는가(Knowing)’로 구성된다.

- **하는 것(Doing)**: 스스로 계산/생성, 타 객체 행동 트리거, 타 객체 활동 제어.
- **아는 것(Knowing)**: 자기 정보, 관련 객체, 유도/계산 가능한 사실.


- '책임'은 곧 객체의 **공용 인터페이스**가 된다.

  → 즉, 외부에 제공해줄 수 있는 **정보**(아는 것의 측면)와 **서비스**(하는 것의 측면)의 목록.


- **메시지 전송**은 다른 객체에게 책임 수행을 '요청'하는 행위다.
  - 책임 → 수신하는 한 쪽의 객체 관점에서 **무엇을 할 수 있는지를 나열**하는 것.
  - 메시지 → 협력에 참여하는 두 객체 사이의 **관계를 강조**한 것.


- 하지만, 책임과 메시지는 같은 수준이 아니며 **하나의 상위 책임**은 실제 협력 설계에서 **여러 메시지**로 분해되는 것이 일반적이다.

## 역할(Role)

---

> 협력 안에서 수행되는 **책임의 집합**(대체 가능한 자리).

- 역할로 **협력을 추상화**하면, **역할을 만족하는 어떤 객체**든 그 자리를 **대체**할 수 있다.
- 같은 역할을 수행하려면 **같은 메시지**를 이해하고 **같은 책임 집합**을 수행해야 한다.  
  → 단순성, 유연성, 재사용성을 높인다.


- 객체는 역할이 암시하는 책임보다 더 많은 책임을 가질 수 있다.
  - 즉, **역할(일반)** ↔ **타입(특수)** 가 **일반화/특수화** 관계를 이룬다.

⇒ 역할의 대체 가능성은 행위 호환성을 의미하고, 행위 호환성은 동일한 책임의 수행을 의미한다.

## 객체의 모양을 결정하는 협력

---

- 객체는 **협력하기 위해 존재**하며, 데이터는 **행동 수행에 쓰이는 수단**이다.
- 클래스는 구현 메커니즘일 뿐, 설계의 중심은 **협력에 참여하는 객체**다.


- **좋은 협력**을 먼저 설계하고, 그 흐름에서 **책임을 식별/할당**한 뒤, 필요한 **데이터와 메서드**를 정한다.
  - 협력 == 참여 객체들이 주고받을 요청과 응답의 흐름을 결정
  - 설계 완료된 협력 == 객체가 협력에 참여하기 위해 수행될 책임


- **협력**이 견고히 갖춰지면 이에 필요한 **책임**으로 흐름이 옮겨진다.

  → **책임의 결정 및 할당**이 얼마나 합리적이고 적절했는지가 **객체지향 설계의 품질**을 결정한다.

⇒ 객체의 ‘행위’에 초점을 맞추기 위해서는 먼저 ‘협력’을 정의해야 한다.

⇒ 객체를 충분히 **협력적**으로 만든 후에, 그 안에서 객체를 충분히 **자율적**으로 만들어야 한다.


## 객체지향 설계 기법

---

### 책임-주도 설계(RDD)
> 협력에 필요한 **책임을 식별**하고 **적절한 객체/역할에 할당**해 시스템을 구성하는 방법.

- 절차 :
  1) 사용자 기능인 **시스템 책임** 파악
  2) 이를 **작은 책임**으로 분할
  3) 각 책임을 수행할 **객체/역할 식별 & 할당**
  4) 수행 중 필요한 **협력자**에게 추가 책임 할당(메시지 연결)
  5) 이 과정을 반복해 **협력 공동체** 구축


### 디자인 패턴(Design Pattern)
> 반복되는 **문제-해법 쌍**에 대한 **역할·책임·협력 템플릿**.  
> RDD 결과물을 **재사용 가능한 형태**로 정리한 설계 경험.


### 테스트-주도 개발(TDD)
> **테스트를 먼저** 작성하고, 테스트를 통과시키는 **최소 코드**를 추가하며, **리팩터링**으로 정제.

- 목적 : 테스트 그 자체보다, 코드를 통해 **역할·책임·협력**을 **발견하고, 검증**하는 것.
- 핵심 : 메시지 수신 시 **기대 결과**와 **협력 관계**를 테스트 코드로 명세한다.  
  → RDD의 목표 달성 과정에 **피드백 루프**를 제공하는 최상 실천법.


- TDD의 진짜 가치는 객체지향 설계 감각과 패턴/원칙에 대한 충분한 이해가 있을 때 극대화된다.
- 설계·패턴 경험이 부족하면 테스트는 구현 확인 수준에 머물고, TDD의 피드백·설계 개선 효과를 온전히 누리기 어렵다.

## 정리

---

- **협력이 우선**이고, 협력이 **책임(행동)** 을 정하며, 그 결과로 **상태/데이터**가 정해진다.
- **역할**은 협력을 추상화하여 **대체 가능성**을 제공하고 설계를 **단순·유연·재사용** 가능하게 만든다.
- **RDD → 패턴 → TDD**는 서로 보완하며, **역할·책임·협력**에 지속적으로 초점을 맞추도록 한다.
